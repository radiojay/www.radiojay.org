
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../Motus-data-tags/">
      
      
        <link rel="next" href="../../aos-2024/">
      
      
      <link rel="icon" href="../../rj.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.41">
    
    
      
        <title>Proposal for Extending the Motus CTT packet format - RadioJay</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#proposal-for-extending-the-motus-ctt-packet-format" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="RadioJay" class="md-header__button md-logo" aria-label="RadioJay" data-md-component="logo">
      
  <img src="../../rj.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            RadioJay
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Proposal for Extending the Motus CTT packet format
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="RadioJay" class="md-nav__button md-logo" aria-label="RadioJay" data-md-component="logo">
      
  <img src="../../rj.png" alt="logo">

    </a>
    RadioJay
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intro
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tags/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Tags
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Tags
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/radiojay-a1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RadioJay A1
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/radiojay-a2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RadioJay A2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tags/radiojay-g1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RadioJay G1
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Whitepapers
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Whitepapers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ultra-lightweight-gps-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ultra-lightweight GPS bird tags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tag-manufacturing-costs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Manufacturing tags and costs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Motus-data-tags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Motus tags that collect data
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Proposal for Extending the Motus CTT packet format
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Proposal for Extending the Motus CTT packet format
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#current-packet-format" class="md-nav__link">
    <span class="md-ellipsis">
      Current packet format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposed-packet-format" class="md-nav__link">
    <span class="md-ellipsis">
      Proposed packet format
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposed packet format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shorter-packet-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      Shorter packet enhancement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packet-format-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Packet format considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-fsk-transmission-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: FSK transmission parameters
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../aos-2024/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    AOS 2024
  </span>
  

            </a>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            AOS 2024
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../related/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Related Work
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#current-packet-format" class="md-nav__link">
    <span class="md-ellipsis">
      Current packet format
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proposed-packet-format" class="md-nav__link">
    <span class="md-ellipsis">
      Proposed packet format
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Proposed packet format">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#shorter-packet-enhancement" class="md-nav__link">
    <span class="md-ellipsis">
      Shorter packet enhancement
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#packet-format-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Packet format considerations
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#appendix-fsk-transmission-parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Appendix: FSK transmission parameters
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="proposal-for-extending-the-motus-ctt-packet-format">Proposal for Extending the Motus CTT packet format</h1>
<p><em>Thorsten von Eicken, 7/11/2024</em></p>
<p>The original packet format used by the Cornell/CTT FSK tags only transmits the tag ID and is not extensible per-se. This proposal extends the format by using some tricks.</p>
<p>The packet extension has been designed with the thought that the Motus stations can become a data collection network where any data sent by tags in the vicinity can be captured, relayed, stored, and made available. The data can hold information about air pressure, animal activity, gps location, cell location, temperature, heart rate, VOC or other chemical air composition, or anything else.</p>
<p>An important constraint for the extension design is to keep backwards compatibility:
existing stations should be able to receive the transmissions of new "data" tags
(just without the data portion) and new
receivers should be able to receive the transmissions of old "data-less" tags.</p>
<h2 id="current-packet-format">Current packet format</h2>
<p>The current packet format consists of:</p>
<ul>
<li>2 byte preamble (alternating 1's and 0's to synchronize the bit clock)</li>
<li>2 byte sync (fixed value to detect the start of actual packet bits)</li>
<li>4 byte ID (the CTT tag ID)</li>
<li>1 byte CRC (SMBUS version, can detect up to 4 bit errors)</li>
</ul>
<p>Total: 9 bytes</p>
<p>The 4-byte ID can encode 2^20 distinct values. Each byte encodes 5 bits using the dictionary:
[ 0x00, 0x07, 0x19, 0x1e, 0x2a, 0x2d, 0x33, 0x34, 0x4b, 0x4c, 0x52, 0x55, 0x61, 0x66, 0x78, 0x7f, 0x80, 0x87, 0x99, 0x9e, 0xaa, 0xad, 0xb3, 0xb4, 0xcb, 0xcc, 0xd2, 0xd5, 0xe1, 0xe6, 0xf8, 0xff ].
CTT seems to use the hex form of the encoded value as "tag ID" (as opposed to the 2^20 values).</p>
<h2 id="proposed-packet-format">Proposed packet format</h2>
<p>The proposed packet format adds more bytes to the end of the current packet, terminated by a 16-bit CRC.
At the receiving end the full length is always received, then the two CRCs are checked and a
determination is made whether the received bytes hold an original short packet, a long packet,
or no packet (noise).</p>
<p>The specific format proposed is:</p>
<ul>
<li>original 9 bytes</li>
<li>1 byte format (4 bits format and 4 bits sub-format or data)</li>
<li>10 bytes data</li>
<li>2 bytes CRC16 (DNP version, can detect up to 6 bit errors, calculated over entire packet starting with ID)</li>
</ul>
<p>Total: 22 bytes</p>
<h3 id="shorter-packet-enhancement">Shorter packet enhancement</h3>
<p>In order to support packet lengths longer than the original CTT 9 bytes but shorter than the 22 bytes the formats could be grouped into lengths. For example:</p>
<ul>
<li>formats 1-4: 14 bytes total, provides 2 bytes of data</li>
<li>formats 5-8: 16 bytes total, provides 4 bytes of data</li>
<li>formats 9-12: 18 bytes total, provides 6 bytes of data</li>
<li>formats 13-15: 22 bytes total, provides 10 bytes of data</li>
</ul>
<h2 id="packet-format-considerations">Packet format considerations</h2>
<p>This packet format was chosen with the following considerations:</p>
<ul>
<li>compatibility with current packet format, such that old receivers can receive the ID (no data)
  of new tags and new receivers can receive the ID of old tags</li>
<li>the total length is roughly 2x the original length so not a high multiplier in TX energy
  requirement and also not a high addition of receiver "deaf time" when only short packets
  are in the air</li>
<li>10 bytes can hold a meaningful amount of data, incl GPS or some historical data</li>
<li>the 16-bit CRC can detect up to 6 bit errors for packet sizes up to 16 bytes, this format
  maximizes the use of the CRC</li>
</ul>
<p>Normally variable-length FSK packets start with a length byte and receivers have support to
automatically stop RX at that length, but this is not an option if compatibility with existing
tags is desired.</p>
<p>Note: it may be possible to define other packet lengths using this same scheme, for example,
packet format 0 could be shorter and tack-on just a 12-bit or 20-bit data value and CRC.</p>
<h2 id="appendix-fsk-transmission-parameters">Appendix: FSK transmission parameters</h2>
<ul>
<li>frequency: 434.0 Mhz</li>
<li>bit rate: 25kbps</li>
<li>deviation: 25kHz (single-sided i.e. MI=2)</li>
<li>channel bandwidth: 50kHz (double-sided) [note: need to double-check!]</li>
<li>NRZ &amp; no whitening, MSB transmitted first</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>